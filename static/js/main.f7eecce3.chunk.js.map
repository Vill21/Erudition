{"version":3,"sources":["components/Line.jsx","SApp.jsx","reportWebVitals.ts","styles/Global.jsx","index.tsx"],"names":["Line","props","word","openedInds","indArr","className","split","map","item","index","find","element","ind","array","API_URL","getWords","a","axios","get","words","data","App","useStateRef","setWords","wordsRef","setIndex","indexRef","points","setPoints","pointsRef","setArr","indArrRef","assistant","useRef","undefined","lives","setLives","livesRef","useEffect","getState","current","getStateForAssistant","createAssistant","on","event","console","log","action","dispatchAssistantAction","_words","sort","Math","random","fetchAndSetWords","state","item_selector","items","question","future","point","arr","type","guess_word","add_life","open_letter","init","Error","handleOnClick","action_id","asked","sendData","payload","isRight","swal","newIndex","life","id","push","style","fontSize","onClick","color","title","size","subTitle","margin","reportWebVitals","onPerfEntry","Function","then","getCLS","getFID","getFCP","getLCP","getTTFB","DocumentStyle","createGlobalStyle","text","background","gradient","ThemeStyle","darkSber","GlobalStyle","ReactDOM","render","StrictMode","document","getElementById"],"mappings":"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","file":"static/js/main.f7eecce3.chunk.js","sourcesContent":["import React, { useEffect } from 'react'\r\nimport \"../SApp.css\";\r\n\r\n//компонент для отрисовки угадываемого слова\r\nexport const Line = (props) => {\r\n    //ответ (верное слово)\r\n    const word = props.word || \"\";\r\n    //флаг конца отгадывания\r\n    const openedInds = props.indArr;\r\n\r\n    return (\r\n        <span className=\"container\">\r\n            {   \r\n                word.split(\"\").map((item, index) => {\r\n                    var isIn = openedInds.find((element, ind, array) => {\r\n                        return (element - 1) === index;\r\n                    });\r\n                    if (isIn) {\r\n                        return (\r\n                            <label className=\"word\" key={index}>{item}</label>\r\n                        );\r\n                    } else {\r\n                        return (\r\n                            <label className=\"word\" key={index}>{}</label>\r\n                        );\r\n                    }\r\n                }) \r\n            }\r\n        </span>\r\n    );\r\n} ","import React, {useState, useRef, useEffect} from \"react\";\r\nimport useStateRef from \"react-usestateref\";\r\nimport swal from 'sweetalert';\r\n\r\nimport {\r\n  createSmartappDebugger,\r\n  createAssistant,\r\n  AssistantSmartAppCommand\r\n} from \"@sberdevices/assistant-client\";\r\nimport { TextBox, Button } from '@sberdevices/plasma-ui';\r\n\r\nimport \"./SApp.css\";\r\nimport {Line} from './components/Line'\r\n\r\nimport axios from \"axios\";\r\nimport { IconHeart } from \"@sberdevices/plasma-icons\";\r\nimport { setRef } from \"@sberdevices/plasma-core/utils\";\r\nconst API_URL = \"https://shielded-escarpment-91826.herokuapp.com/words/\";\r\n\r\nasync function getWords() {\r\n  const {data: words} = await axios.get(API_URL);\r\n  return words;\r\n}\r\n\r\nasync function updateWords(id, payload) {\r\n  const {data: newWord} = await axios.put(`${API_URL}${id}`, payload);\r\n  return newWord;\r\n}\r\n\r\nconst initializeAssistant = (getState/*: any*/) => {\r\n  if (process.env.NODE_ENV === \"development\") {\r\n    return createSmartappDebugger({\r\n      token: process.env.REACT_APP_TOKEN ?? \"\",\r\n      initPhrase: `Запусти ${process.env.REACT_APP_SMARTAPP}`,\r\n      getState,\r\n    });\r\n  }\r\n  return createAssistant({ getState });\r\n};\r\n\r\nexport const App = () => {\r\n  //флаг конца отгадывания\r\n  const [words, setWords, wordsRef] = useStateRef([]);\r\n  const [index, setIndex, indexRef] = useStateRef(0);\r\n  const [points, setPoints, pointsRef] = useStateRef(0);\r\n  const [indArr, setArr, indArrRef] = useStateRef([]);\r\n  const assistant = useRef(undefined);\r\n  const [lives, setLives, livesRef] = useStateRef(0);\r\n  \r\n  //инициализирует голосовой ассистент\r\n  useEffect(() => {\r\n    assistant.current = initializeAssistant(() => getStateForAssistant());\r\n    //Осуществляет подписку на событие готовности ассистента к работе.\r\n    assistant.current.on(\"start\", (event) => {\r\n      console.log(`assistant.on(start)`, event);\r\n    });\r\n    //Осуществляет подписку на событие получения данных с бэкенда. \r\n    //Получает команды из appInitialData, если при запуске смартапа не была вызвана команда getInitialData().\r\n    assistant.current.on(\"data\", (event) => {\r\n      console.log(`assistant.on(data)`, event);\r\n      const { action } = event;\r\n      dispatchAssistantAction(action);\r\n    });\r\n  }, [])\r\n\r\n  useEffect(() => {\r\n    const fetchAndSetWords = async () => {\r\n      const _words = await getWords();\r\n      _words.sort(() => Math.random() - 0.5);\r\n      console.log(_words);\r\n      setWords(_words);\r\n    }\r\n    fetchAndSetWords();\r\n  }, [])\r\n\r\n  const getStateForAssistant = () => {\r\n    console.log('getStateForAssistant: this.state:', pointsRef?.current)\r\n    const state = {\r\n      item_selector: {\r\n        //Список соответствий между голосовыми командами и действиями в приложении.\r\n        items: {\r\n            word: wordsRef?.current?.[indexRef?.current]?.[\"word\"],\r\n            question: wordsRef?.current?.[indexRef?.current]?.[\"question\"],\r\n            future: wordsRef?.current?.[indexRef?.current + 1]?.[\"question\"],\r\n            point: pointsRef?.current,\r\n            lives: livesRef?.current,\r\n            arr: indArrRef?.current\r\n          },\r\n      },\r\n    };\r\n    console.log('getStateForAssistant: state:', state)\r\n    return state;\r\n  }\r\n\r\n  //распознает запросы для голосового ассистента\r\n  const dispatchAssistantAction = (action) => {\r\n    console.log('dispatchAssistantAction', action);\r\n      if (action) {\r\n      switch (action.type) {\r\n        case 'guess_word':\r\n          //вызывает функцию в ответ на распознанное действие\r\n          return guess_word(action);\r\n        case 'add_life':\r\n          return add_life();\r\n        case 'open_letter':\r\n          return open_letter(action);  \r\n        case 'init':\r\n          return init();      \r\n        default:\r\n          throw new Error();\r\n      }\r\n    }\r\n  }\r\n\r\n  const handleOnClick = (action_id, asked) => {\r\n    console.log(\"START\")\r\n    // Отправка сообщения ассистенту с фронтенд.\r\n    // Структура может меняться на усмотрение разработчика, в зависимости от бэкенд\r\n    assistant?.current?.sendData({ \r\n      action: \r\n        { \r\n          action_id: action_id, \r\n          payload: {\r\n            asked: asked\r\n          } \r\n        }\r\n      });\r\n  };\r\n\r\n  const init = () => {\r\n    handleOnClick('say_question', 'Огласи вопрос')\r\n  }\r\n\r\n  //функция обработчик введенного слова\r\n  const guess_word = (action) => {\r\n    const guessed = action.isRight;\r\n    \r\n    if (guessed === true) {\r\n      swal(\"Верно!\", `Слово: ${wordsRef?.current?.[indexRef?.current]?.[\"word\"]}`, \"success\");\r\n      const newIndex = indexRef?.current + 1;\r\n      setIndex(newIndex);\r\n      const point = pointsRef?.current + 1;\r\n      setArr([]);\r\n      setPoints(point);\r\n      handleOnClick('say_question', 'Огласи вопрос');\r\n    } else if (livesRef?.current > 0) {\r\n      let life = livesRef?.current - 1;\r\n      setLives(life);\r\n      swal(`У вас осталось ${livesRef?.current} попыток`, \"\", \"error\");\r\n    }else {\r\n      swal(\"Попробуйте снова :(\", \"\", \"error\");\r\n      setPoints(0);\r\n    }\r\n  }\r\n\r\n  const add_life = () => {\r\n      let life = livesRef?.current + 1;\r\n      setLives(life);\r\n      const point = pointsRef?.current - 2;\r\n      setPoints(point);\r\n  }\r\n\r\n  const open_letter = (action) => {\r\n    const id = action.id;\r\n    const arr = indArrRef?.current;\r\n    arr.push(id);\r\n    setArr(arr);\r\n    const point = pointsRef?.current - 1;\r\n    setPoints(point);\r\n  }\r\n\r\n  return (\r\n    <div className=\"content\">\r\n      <div>\r\n      <label style={\r\n          {fontSize: \"24pt\"}\r\n        }\r\n      >Угаданные подряд: {points}</label>\r\n      <button onClick={() => {handleOnClick('add_life', 'Купить жизнь')}} className=\"shine-button\"><IconHeart color=\"#FF0000\" /><label style={{fontSize: \"24pt\"}}>: {lives}</label></button>\r\n      </div>\r\n      <Line word={wordsRef?.current?.[indexRef?.current]?.[\"word\"]} indArr={indArr}/>\r\n      <TextBox \r\n        title=\"Загадка:\" \r\n        size=\"l\" \r\n        subTitle={wordsRef?.current?.[indexRef?.current]?.[\"question\"]} \r\n        style={\r\n          {margin: \"5% 0 0 0\",\r\n          fontSize: \"24pt\"}\r\n        }/>\r\n    </div>\r\n  );\r\n}\r\n","import { ReportHandler } from 'web-vitals';\r\n\r\nconst reportWebVitals = (onPerfEntry?: ReportHandler) => {\r\n  if (onPerfEntry && onPerfEntry instanceof Function) {\r\n    import('web-vitals').then(({ getCLS, getFID, getFCP, getLCP, getTTFB }) => {\r\n      getCLS(onPerfEntry);  \r\n      getFID(onPerfEntry);\r\n      getFCP(onPerfEntry);\r\n      getLCP(onPerfEntry);\r\n      getTTFB(onPerfEntry);\r\n    });\r\n  }\r\n}\r\n\r\nexport default reportWebVitals;\r\n","import { createGlobalStyle } from 'styled-components';\r\nimport { darkSber } from '@sberdevices/plasma-tokens/themes'; // Или один из списка: darkEva, darkJoy, lightEva, lightJoy, lightSber\r\nimport {\r\n    text, // Цвет текста\r\n    background, // Цвет подложки\r\n    gradient, // Градиент\r\n} from '@sberdevices/plasma-tokens';\r\n\r\nconst DocumentStyle = createGlobalStyle`\r\n    html:root {\r\n        min-height: 100vh;\r\n        color: ${text};\r\n        background-color: ${background};\r\n        background-image: ${gradient};\r\n    }\r\n`;\r\nconst ThemeStyle = createGlobalStyle(darkSber);\r\nexport const GlobalStyle = () => (\r\n    <>\r\n        <DocumentStyle />\r\n        <ThemeStyle />\r\n    </>\r\n);","import React from \"react\";\r\nimport ReactDOM from \"react-dom\";\r\nimport \"./index.css\";\r\nimport { App } from \"./SApp\";\r\nimport reportWebVitals from \"./reportWebVitals\";\r\n\r\nimport { DeviceThemeProvider } from '@sberdevices/plasma-ui/components/Device'; // Типографика, имеющая размеры, зависимые от типа устройства\r\nimport { GlobalStyle } from './styles/Global'; // Тема оформления (цветовая схема)\r\n\r\nReactDOM.render(\r\n  <React.StrictMode>\r\n    <GlobalStyle />\r\n    <App />\r\n  </React.StrictMode>,\r\n  document.getElementById(\"root\")\r\n);\r\n\r\n// If you want to start measuring performance in your app, pass a function\r\n// to log results (for example: reportWebVitals(console.log))\r\n// or send to an analytics endpoint. Learn more: https://bit.ly/CRA-vitals\r\nreportWebVitals();\r\n"],"sourceRoot":""}